name: Test Neutron Port
description: |
  Integration test for neutron floating ip endpoint.

clients:
  default:
    id: alice
    password: alice_password
    domain: default
    insecure: true
    scope:
      project:
        name: admin

workflow:
- name: Port read create
  request:
    path: /neutron/port
    method: POST
    expected: [200]
    data:
      data:
        fields: 
        resource:
          description: ''
          admin_state_up: true
          network_id: c8012c97-5e6a-41f8-8e43-97427d836b0d
          tenant_id: 8cdb5412f5974b38a69f2f9d1ae969b7
          extra_dhcp_opts: 
          name: ''
          device_owner: ''
          binding:vnic_type: normal
          project_id: 8cdb5412f5974b38a69f2f9d1ae969b7
          security_groups:
          - 79ce33bf-1bac-48d5-8bbb-5782e26b3db8
          device_id: ''
        filters: 
      context:
        user_id: 06be3763c8224dd5a343e3d95d87c1d2
        roles:
        - heat_stack_owner
        - admin
        tenant_id: 8cdb5412f5974b38a69f2f9d1ae969b7
        is_admin: true
        request_id: req-db7a6a99-6dd0-46ae-9b61-a675e99ab70e
        operation: CREATE
        type: port
        tenant: 8cdb5412f5974b38a69f2f9d1ae969b7
  expect: 
    status: DOWN
#    created_at: '2018-12-06T11:30:11.787306'
    port_security_enabled: true
    binding:host_id: "host_id"
    name: $uuid
#    allowed_address_pairs: []
#    admin_state_up: true
#    network_id: c8012c97-5e6a-41f8-8e43-97427d836b0d
#    tenant_id: 8cdb5412f5974b38a69f2f9d1ae969b7
#    binding:vif_details:
#      port_filter: true
#    description: ''
#    updated_at: '2018-12-06T11:30:11.877835'
#    binding:vnic_type: normal
#    binding:vif_type: vrouter
#    device_owner: ''
#    mac_address: 02:c9:08:8d:8c:ec
#    fq_name:
#    - default-domain
#    - admin
#    - c9088d8c-ecd1-472a-9190-905c28a22f53
#    fixed_ips:
#    - subnet_id: a46ff943-72cd-41dc-b92b-a997c1287856
#      ip_address: 10.0.1.3
#    id: c9088d8c-ecd1-472a-9190-905c28a22f53
#    security_groups:
#    - 79ce33bf-1bac-48d5-8bbb-5782e26b3db8
#    device_id: ''

- name: Port read read all
  request:
    path: /neutron/port
    method: POST
    expected: [200]
    data:
      data:
        fields: []
        filters:
          tenant_id:
          - 8cdb5412f5974b38a69f2f9d1ae969b7
      context:
        user_id: 06be3763c8224dd5a343e3d95d87c1d2
        roles:
        - heat_stack_owner
        - admin
        tenant_id: 8cdb5412f5974b38a69f2f9d1ae969b7
        is_admin: true
        request_id: req-7ef05a71-0a78-4616-8741-64380919f5af
        operation: READALL
        type: port
        tenant: 8cdb5412f5974b38a69f2f9d1ae969b7
    expect: []
